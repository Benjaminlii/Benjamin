# 第三章 内存管理

------

[TOC]

------

## 1. 基础知识

### (1). 逻辑地址和物理地址

​		物理地址是当前数据在整个计算机内存中的绝对位置,逻辑地址是指当前数据在本进程之内的偏移量地址.

​		逻辑地址+进程首地址=物理地址

## 2. 内存管理的概念

### (1). 内存管理的内容

-   内存空间的分配与回收
-   使用虚拟技术对内存空间进行扩充
-   将逻辑地址与物理地址进行转换
-   内存保护功能,保证各个进程在各自的内存空间中运行,互不干扰
    -   上限寄存器和下限寄存器之间的内存可以访问
    -   重定位寄存器+逻辑地址(界地址寄存器存放最大逻辑地址)

### (2). 覆盖与交换

​		程序大小通常超过物理内存总和

#### 1). 覆盖技术

​		覆盖技术是指将程序分为多个段,使用的那一部分调入内存,不使用的部分在需要时才会调入内存.

​		常驻内存的段放在固定区中,调入后不在调出.不常住的段放在覆盖区,需要时调入,采取覆盖策略

​		程序员必须显式声明覆盖结构

#### 2). 交换技术

​		当内存空间紧张时,将内存中某些进程暂时调出外存,把外存中某些已经具备运行条件的进程调入内存(内存和磁盘中动态调度)

​		中级调度就是判断哪一些进程适应给被调入的.

​		暂时换出外存等待的进程状态被称为挂起态.

​		对应于此,磁盘空间也被分为对换区和文件区.对换区追求文件换入换出速度,采用连续分配方式.文件区追求空间的利用率,采用离散分配方式.总之对换区的I/O速度比文件区更快.

### (3). 连续分配管理方式

​		连续分配是指为用户进程分配的必须是一个连续的内存空间.

​		外部碎片:没有分配的内存过小,无法分配给进程

​		内部碎片:分配给进程的内存无法被全部利用

#### 1). 单一连续分配

​		将整个内存空间全部分配给一个用户区

​		无外部碎片但是有大量的内部碎片,并且只能用于单用户单道

​		存储器利用率极低

#### 2). 固定分区分配

​		系统将用户空间划分为若干固定大小的区,每一个进程占用一个区.

-   分区大小相等

    -   缺乏灵活性
    -   但是很适合控制多个相同对象

-   分区大小不相等

    -   增加了灵活性
    -   常在系统中根据作业的大小分配内存

    无外部碎片

    有大量的内部碎片

![1574602420598](/home/benjamin/.config/Typora/typora-user-images/1574602420598.png)

#### 3). 动态分区分配

​		不会预先划分内存分区,而是在进程装入内存时,根据进程的大小动态的建立分区.

​		空闲分区表:记录了每一个未被分配的分区(由已分配分区划分而出)的相关信息.

​		没有内部碎片,但是有外部碎片

​		可以通过紧凑技术解决外部碎片.

### (4). 动态分区分配算法

#### 1). 首次适应算法

​		空闲分区以地址递增的次序排列,每次按顺序查找大小能满足的第一个空闲分区.

#### 2). 最佳适应算法

​		空闲分区按大小递增排列,每次查找的都是满足大小的第一个.

​		尽可能的减少外部碎片,但是查找的耗时较长

#### 3). 最坏适应算法

​		空闲分区按照大小递减排列,每次找到大小满足的第一个空闲分区.

​		好处是匹配起来非常快,坏处是后面的大进程可能会无空间可用.

#### 4). 邻近适应算法

​		每次都从上次结束的位置开始检索.

​		循环链表实现.

![1574606595169](/home/benjamin/.config/Typora/typora-user-images/1574606595169.png)

### (5). 基本分页存储管理

​		把内存分为一个个相等的小分区,称为页框,再按照分区大小将用户进程分为若干小分区,成为页面.每一个页面都对应分配一个页框.

​		分区大小越小,内部碎片就越小,内存利用率越高

​		各个页面不必连续存放,也不必按照先后顺序来,可以放到不相邻的各个页框中.