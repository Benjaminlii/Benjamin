# 第4章 语法分析

------

[TOC]

------

## 1. 自顶向下分析概述

​		从分析树的根节点向叶节点方向构造分析树,可以看做是从文法开始符号推导出词串的过程

### (1). 最左推导

​		在最左推导中,总是选择每个句型的最左侧非终结符进行替换.

### (2). 递归向下分析

​		计算机程序实现的自顶向下分析的通用形式.

​		每层递归对应一个非终结符(相当于遍历一个树的子节点,非终结符对应的是非叶子节点)

​		搭配回溯使用

## 2. 文法转换

### (1). 消除直接左递归

​		当同一个非终结符的多个候选式存在相同的前缀时,会导致回溯(最终只会匹配其中一个)

​		将含有 A->Aα 形式产生式的文法称为是直接左递归的.使用最左推导的递归向下分析可能会无限递归.

A -> Aα | β    ===>    A -> βA'   其中 A' -> αA' | ε

​		因为是左递归,所以都是A->βααααααα......这样的,那么把第一个β抽取出来,再新建立一个A'->αααααα....就可以替换左递归.其中后面新建立的这个式子是右递归的.

### (2). 消除间接左递归

​		S -> Aa | b

​		A -> Ac | Sd | ε

​		这里的递归是间接存在于两条文法中的.

​		将两个式子代入,编程直接左递归,然后消除直接左递归

![1573666379351](/home/benjamin/.config/Typora/typora-user-images/1573666379351.png)

### (3). 提取左公因式

![1573666482505](/home/benjamin/.config/Typora/typora-user-images/1573666482505.png)

​		推迟决定,等待获取到了足够的信息在做出选择.

## 3. LL1文法

### (1). 预测分析法

​		在自顶向下的分析中,可能会遇到回溯.如果能够预先读取几个字符,就可以避免很多回溯.

​		LL1就是使用预先读取一个字符的预测分析技术的文法.

#### 1). 工作过程

​		从文法开始符号出发,每一步根据当前句型的最左非终结符和当前输入符号,选择正确的产生式,所选出的产生式必须是唯一的.

​		文法最好满足的条件,即S_文法(简单的确定性文法):

-   每个产生式的右部都以终结符开始(每一次推导都能确定一个字符)
-   同一个非终结符的各个候选式的首终结符都不同.(每读入一个字符都决定依次推导,不会有回溯)

​		在推导过程中,如果当前的文法不匹配,能否使用空产生式取决于当前输入的符号是否在使用空产生式后能够被接收.(也就是跳过空产生式能否匹配)

### (2). 非终结符的后继符号集

​		非终结符A的后继符号集就是指可能在某个句型中紧跟在A后面的终结符a的集合.记为**<u>FOLLOW(A)</u>**

### (3). 产生式的可选集

​		产生式 A -> β的可选集是指可以选用该产生式**<u>进行推导时对应的输入符号</u>**的概念.记为**<u>SELECT(A->β)</u>**

-   SELECT(A->aβ) = {a} (这里就是明显的可以接收字符a)
-   SELECT(A->ε) = FOLLOW(A) (这里是非终结符A选择推导为空产生式的条件就是遇到了可以接收的终结符)

q_文法:

-   每个产生式的右部要么是ε,要么以终结符开始
-   相同左部的产生式有不想交的可选集

### (4). 串首终结符集

​		作为串首的第一个符号,并且是终结符.

​		给定一个文法符号串α,α的串首终结符集**<u>FIRST(α)</u>**被定义为可以从α推导出的所有串首终结符构成的集合.

​		(α等价的所有串的首字符)

​		如果α能推出空串,那么空串也在FIRST集中.

​		那么,是不是意味着,如果FIRST(α)中不包含空串,那么SELECT(A->α) = FIRST(α).(如果该串A通过一个文法一定能推出来一个串,那么使用该文法记性推导时索要输入的字符一定是α的等价串的首字符.....好像废话了)

​		如果FIRST(α)中包含空串,那么SELECT(A->α) = ( FIRST(α)-{ε} ) ∪ FOLLOW(A)(如果这个串A通过一个文法可能会推出空串,那么需要读入一个α等价串首字符-空字符 和 A后面可以接受的任意一个字符,也就是直接将A推导为空串)

​		总结:有文法A->α, 如果α可以推出空串,那么本次推导可以输入α等价串的首字符(除去空串)和A的任意后继终结符(直接将A推导为空串).如果不能推出空串,那么只能输入α等价串的首字符.