# MySQL面试中常见问题总结

-----

[TOC]

-----

## 1. JDBC连接的过程

1.  加载驱动
    1.  Class.forName("com.mysql.jdbc.Driver");
1.  通过协议,子协议,ip,端口,URL创建连接,获取到连接对象
    1.  Connection connection = DriverManager.getConnection("jdbc:mysql://xxx.xxx.xxx.xxx/jdbc?xxxxxx&xxxxx")
1.  编写sql语句
1.  传入sql,获得statement对象
    1.  PreparedStatement ps = connection.prepareStatement
    1.  如果是加参数的sql(?作为占位符),需要填充参数
    1.  ps.setObject(1, obj)
1.  执行statement中的sql,获得结果集
    1.  ResultSet resultSet=statement.executeQuery();
    1.  ResultSet resultSet=statement.executeUpdate();
    1.  ResultSet resultSet=statement.execute();
1.  处理结果集
    1.  rs.next()  类似于迭代器

## 2. 连接池

​		在程序运行中,如果每次访问数据库都需要建立连接,使用完毕之后在关闭连接.网络开销和对系统资源的占用都非常大.那么依据资源池的思想,将连接使用完之后不进行关闭,而是放入连接池中,下一次进行重用.这就诞生了连接池

### (1). 连接池的工作原理

1.  连接池的建立
    1.  系统初始化时会根据系统配置建立连接池,并初始化几个连接对象.
1.  连接池的管理
    1.  请求连接
        1.  当线程请求数据库连接时,如果有空闲连接,分配给线程使用
        1.  如果没有空闲连接,那么判断当前连接数量是否超出连接池上限
        1.  如果没有,那么创建新的连接
        1.  如果已经达到上限,任务等待
        1.  任务等待时间超出最大等待时间时,抛出异常
    1.  释放连接
        1.  当线程释放数据库连接时,会判断当前连接的引用次数是否超过规定值
        1.  如果超过,就从连接池中删除这个连接,否则进行白柳
1.  连接池的关闭
    1.  当应用程序退出时,关闭连接池中的所有连接,释放相关资源

### (2). 连接池主要参数

-   最小连接数:初始化时就要达到的连接数量
-   最大连接数:字面意思
-   最大空闲时间:连接不被使用的最大时间,为了避免过多占用系统内存
-   获取连接超时时间
-   超时重连次数

## 3. 数据库范式

​		[如何理解关系型数据库的常见设计范式？](https://www.zhihu.com/question/24696366/answer/29189700)

​		主码是指主键的集合(一张表被多个键唯一确定)

​		主码中的每一个属性都是主属性.

### (1). 第一范式(1NF)

​		属性域不可分割,要具有原子性.

### (2). 第二范式(2NF)

​		非主属性必须完全依赖于主码(完全依赖是指不能被其一部分决定).

### (3). 第三范式(3NF)

​		非主属不能依赖于其他非主属性.

### (4). 巴斯范式(BCNF)

​		所有属性(这里主要针对的是主属性)不能对主属性有传递依赖.(不能传递依赖,也就是主属性之间不能相互依赖)

## 4. InnoDB和MyISAM区别

[mysql中innodb和myisam对比及索引原理区别](https://blog.csdn.net/qq_27607965/article/details/79925288)

|            | InnoDB                                                       | MyISAM                                                       |
| ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 锁         | 支持行锁                                                     | 只支持表锁                                                   |
| 事务       | 支持完整的事务                                               | 通过锁表来模拟事务                                           |
| 表的组织   | 索引组织表,共享表空间和多表空间存储                          | 堆表,tableName.frm用于存储表的定义,tableName.MYD用于存放数据,tableName.MYI用于存放表索引 |
| 主键       | 如果没有显式的定义主键,会自动生成一个用户不可见的6字节的主键 | 允许没有主键的表存在                                         |
| 索引的保存 | 和数据一起保存,也就是聚集索引                                | 单独存放,非聚集索引                                          |
| 辅助索引   | 存储主键                                                     | 存储指向数据的指针                                           |
| 外键       | 支持                                                         | 不支持                                                       |
| count      | 遍历整个表                                                   | 有数据存储总数,读取该值即可                                  |
| 并发       | 分为读锁和写锁                                               | 读和写都是相互阻塞的                                         |

​		因为辅助索引存储指针,多查询的表使用MyISAM效率会高很多.

​		InnoDB的表锁会让表的插入删除更新操作的效率高于MyISAM